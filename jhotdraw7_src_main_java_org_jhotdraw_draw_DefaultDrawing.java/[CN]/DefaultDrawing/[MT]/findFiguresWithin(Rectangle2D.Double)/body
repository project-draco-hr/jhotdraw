{
  LinkedList<Figure> contained=new LinkedList<Figure>();
  for (  Figure f : getChildren()) {
    Rectangle2D.Double r=f.getBounds();
    if (AttributeKeys.TRANSFORM.get(f) != null) {
      Rectangle2D rt=AttributeKeys.TRANSFORM.get(f).createTransformedShape(r).getBounds2D();
      r=(rt instanceof Rectangle2D.Double) ? (Rectangle2D.Double)rt : new Rectangle2D.Double(rt.getX(),rt.getY(),rt.getWidth(),rt.getHeight());
    }
    if (f.isVisible() && Geom.contains(bounds,r)) {
      contained.add(f);
    }
  }
  return contained;
}
