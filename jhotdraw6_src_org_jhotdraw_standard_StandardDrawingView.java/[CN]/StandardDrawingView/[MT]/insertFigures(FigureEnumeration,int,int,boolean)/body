{
  if (fe == null) {
    return FigureEnumerator.getEmptyEnumeration();
  }
  List addedFigures=CollectionsFactory.current().createList();
  List vCF=CollectionsFactory.current().createList(10);
  while (fe.hasNextFigure()) {
    Figure figure=fe.nextFigure();
    if (figure instanceof ConnectionFigure) {
      vCF.add(figure);
    }
 else     if (figure != null) {
      figure.moveBy(dx,dy);
      figure=add(figure);
      addToSelection(figure);
      addedFigures.add(figure);
    }
  }
  FigureEnumeration ecf=new FigureEnumerator(vCF);
  while (ecf.hasNextFigure()) {
    ConnectionFigure cf=(ConnectionFigure)ecf.nextFigure();
    Figure sf=cf.startFigure();
    Figure ef=cf.endFigure();
    if (figureExists(sf,drawing().figures()) && figureExists(ef,drawing().figures()) && (!bCheck || cf.canConnect(sf,ef))) {
      if (bCheck) {
        Point sp=sf.center();
        Point ep=ef.center();
        Connector fStartConnector=cf.startFigure().connectorAt(ep.x,ep.y);
        Connector fEndConnector=cf.endFigure().connectorAt(sp.x,sp.y);
        if (fEndConnector != null && fStartConnector != null) {
          cf.connectStart(fStartConnector);
          cf.connectEnd(fEndConnector);
          cf.updateConnection();
        }
      }
      Figure nf=add(cf);
      addToSelection(nf);
      addedFigures.add(nf);
    }
  }
  return new FigureEnumerator(addedFigures);
}
