{
  List<Component> allChildren=new ArrayList<Component>();
  for (  Component root : roots) {
    if (root != null) {
      Property p=getProperty(root);
      if (p != null) {
        String pathname=getComponentPathname(root);
        if (pathname != null) {
          Object state=stateMap.get(pathname);
          if (state != null) {
            p.setSessionState(root,state);
          }
 else {
            logger.warning("No saved state for " + root);
          }
        }
      }
    }
    if (root instanceof Container) {
      Component[] children=((Container)root).getComponents();
      if ((children != null) && (children.length > 0)) {
        Collections.addAll(allChildren,children);
      }
    }
  }
  if (allChildren.size() > 0) {
    restoreTree(allChildren,stateMap);
  }
}
