{
  if (!p.isShowing()) {
    p.setShowing(true);
    File file=p.getFile();
    final JFrame f=new JFrame();
    String title;
    if (file == null) {
      title=labels.getString("unnamedFile");
    }
 else {
      title=file.getName();
    }
    if (p.hasUnsavedChanges()) {
      title+="*";
    }
    f.setTitle(labels.getFormatted("frameTitle",title,getName(),p.getMultipleOpenId()));
    f.setDefaultCloseOperation(JFrame.DO_NOTHING_ON_CLOSE);
    JPanel panel=(JPanel)wrapProjectComponent(p);
    f.add(panel);
    f.setMinimumSize(new Dimension(200,200));
    f.setPreferredSize(new Dimension(600,400));
    f.setJMenuBar(createMenuBar(p,(java.util.List<Action>)panel.getClientProperty("toolBarActions")));
    PreferencesUtil.installFramePrefsHandler(prefs,"project",f);
    Point loc=f.getLocation();
    boolean moved;
    do {
      moved=false;
      for (Iterator i=projects().iterator(); i.hasNext(); ) {
        Project aProject=(Project)i.next();
        if (aProject != p && SwingUtilities.getWindowAncestor(aProject.getComponent()) != null && SwingUtilities.getWindowAncestor(aProject.getComponent()).getLocation().equals(loc)) {
          loc.x+=22;
          loc.y+=22;
          moved=true;
          break;
        }
      }
    }
 while (moved);
    f.setLocation(loc);
    f.addWindowListener(new WindowAdapter(){
      public void windowClosing(      final WindowEvent evt){
        setCurrentProject(p);
        getApplication().getAction(CloseAction.ID).actionPerformed(new ActionEvent(f,ActionEvent.ACTION_PERFORMED,"windowClosing"));
      }
      public void windowActivated(      WindowEvent e){
        setCurrentProject(p);
      }
    }
);
    p.addPropertyChangeListener(new PropertyChangeListener(){
      public void propertyChange(      PropertyChangeEvent evt){
        String name=evt.getPropertyName();
        if (name.equals("hasUnsavedChanges") || name.equals("file") || name.equals("multipleOpenId")) {
          File file=p.getFile();
          String title;
          if (file == null) {
            title=labels.getString("unnamedFile");
          }
 else {
            title=file.getName();
          }
          if (p.hasUnsavedChanges()) {
            title+="*";
          }
          f.setTitle(labels.getFormatted("frameTitle",title,getName(),p.getMultipleOpenId()));
        }
      }
    }
);
    f.setVisible(true);
  }
}
