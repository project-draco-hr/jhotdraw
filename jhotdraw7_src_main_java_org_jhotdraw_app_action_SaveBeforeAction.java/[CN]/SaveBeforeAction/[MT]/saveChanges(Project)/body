{
  if (p.getFile() == null) {
    JFileChooser fileChooser=p.getSaveChooser();
    JSheet.showSaveSheet(fileChooser,p.getComponent(),new SheetListener(){
      public void optionSelected(      final SheetEvent evt){
        if (evt.getOption() == JFileChooser.APPROVE_OPTION) {
          final File file;
          if (evt.getFileChooser().getFileFilter() instanceof ExtensionFileFilter) {
            file=((ExtensionFileFilter)evt.getFileChooser().getFileFilter()).makeAcceptable(evt.getFileChooser().getSelectedFile());
          }
 else {
            file=evt.getFileChooser().getSelectedFile();
          }
          saveToFile(p,file);
        }
 else {
          p.setEnabled(true);
          if (oldFocusOwner != null) {
            oldFocusOwner.requestFocus();
          }
        }
      }
    }
);
  }
 else {
    saveToFile(p,p.getFile());
  }
}
