{
  T oldValue=figure.set(key,newValue);
  if (!Objects.equals(oldValue,newValue)) {
    final DirtyMask dm;
    if (key instanceof FigureMapAccessor) {
      FigureMapAccessor<T> fk=(FigureMapAccessor<T>)key;
      dm=fk.getDirtyMask();
    }
 else {
      dm=DirtyMask.EMPTY;
    }
    if (dm.containsOneOf(DirtyBits.NODE)) {
      fire(DrawingModelEvent.nodeInvalidated(this,figure));
    }
  }
  return oldValue;
}
