{
  for (  Figure child : getChildren()) {
    Transform p2c=child.getParentToLocal();
    if (p2c.isIdentity()) {
      child.reshape(transform);
    }
 else     if (child instanceof TransformableFigure) {
      TransformableFigure tchild=(TransformableFigure)child;
      if (transform instanceof Translate) {
        p2c=tchild.getTransform();
        Point2D tr=new Point2D(transform.getTx(),transform.getTy());
        tr=Geom.toDeltaTransform(p2c).transform(tr);
        Transform t=new Translate(tr.getX(),tr.getY());
        tchild.reshape(t);
      }
 else {
        tchild.reshape(p2c.createConcatenation(transform));
      }
    }
  }
}
