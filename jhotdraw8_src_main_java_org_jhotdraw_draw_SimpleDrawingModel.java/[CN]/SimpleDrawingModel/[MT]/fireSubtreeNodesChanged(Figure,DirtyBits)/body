{
  DirtyMask mask=DirtyMask.of(bits);
  fire(DrawingModelEvent.subtreeNodesChanged(this,figure));
  if (mask.containsOneOf(DirtyBits.LAYOUT_BOUNDS,DirtyBits.GEOMETRY)) {
    for (    Figure f : figure.preorderIterable()) {
      if (f instanceof ConnectableFigure) {
        ConnectableFigure connectable=(ConnectableFigure)f;
        for (        ConnectionFigure connection : connectable.connections()) {
          fire(DrawingModelEvent.nodeChanged(this,connection));
        }
      }
    }
  }
  fireInvalidated();
}
