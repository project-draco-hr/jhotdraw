{
  final View v=unsavedView;
  v.execute(new Worker<Object>(){
    @Override protected Object construct() throws IOException {
      v.write(uri,chooser);
      return null;
    }
    @Override protected void done(    Object value){
      v.setURI(uri);
      doExit();
    }
    @Override protected void failed(    Throwable error){
      ResourceBundleUtil labels=ResourceBundleUtil.getBundle("org.jhotdraw.app.Labels");
      JSheet.showMessageSheet(v.getComponent(),"<html>" + UIManager.getString("OptionPane.css") + "<b>"+ labels.format("file.save.couldntSave.message",URIUtil.getName(uri))+ "</b><p>"+ error,JOptionPane.ERROR_MESSAGE);
    }
    @Override public void finished(){
      v.setEnabled(true);
      if (oldFocusOwner != null) {
        oldFocusOwner.requestFocus();
      }
      getApplication().setEnabled(true);
    }
  }
);
}
