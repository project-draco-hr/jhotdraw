{
  InputStream in=null;
  try {
    in=new BufferedInputStream(new FileInputStream(f));
    StorageFormat sf=new SVGInputFormat();
    final Drawing drawing=new QuadTreeDrawing();
    sf.read(in,drawing,new LinkedList<Figure>());
    SwingUtilities.invokeAndWait(new Runnable(){
      public void run(){
        view.getDrawing().removeUndoableEditListener(undo);
        view.setDrawing(drawing);
        view.getDrawing().addUndoableEditListener(undo);
        undo.discardAllEdits();
      }
    }
);
  }
 catch (  InterruptedException e) {
    InternalError error=new InternalError();
    e.initCause(e);
    throw error;
  }
catch (  InvocationTargetException e) {
    InternalError error=new InternalError();
    e.initCause(e);
    throw error;
  }
 finally {
    if (in != null)     try {
      in.close();
    }
 catch (    IOException e) {
    }
    ;
  }
}
