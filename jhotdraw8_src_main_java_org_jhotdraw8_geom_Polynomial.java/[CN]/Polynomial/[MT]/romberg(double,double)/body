{
  int MAX=20;
  int K=3;
  double TOLERANCE=1e-6;
  double[] s=new double[MAX + 1];
  double[] h=new double[MAX + 1];
  YDY result=new YDY(0,0);
  h[0]=1.0;
  for (int j=1; j <= MAX; j++) {
    s[j - 1]=this.trapezoid(min,max,j);
    if (j >= K) {
      result=Polynomial.interpolate(h,s,K,j - K,0.0);
      if (Math.abs(result.dy) <= TOLERANCE * result.y) {
        break;
      }
    }
    s[j]=s[j - 1];
    h[j]=0.25 * h[j - 1];
  }
  return result.y;
}
