{
  final ExportableDocumentView documentView=(ExportableDocumentView)getCurrentView();
  if (documentView.isEnabled()) {
    ResourceBundleUtil labels=ResourceBundleUtil.getLAFBundle("org.jhotdraw.application.Labels");
    oldFocusOwner=SwingUtilities.getWindowAncestor(documentView.getComponent()).getFocusOwner();
    documentView.setEnabled(false);
    File saveToFile;
    JFileChooser fileChooser=documentView.getExportChooser();
    JSheet.showSheet(fileChooser,documentView.getComponent(),labels.getString("filechooser.export"),new SheetListener(){
      public void optionSelected(      final SheetEvent evt){
        if (evt.getOption() == JFileChooser.APPROVE_OPTION) {
          final File file=evt.getFileChooser().getSelectedFile();
          exportToFile(documentView,file,evt.getFileChooser().getFileFilter(),evt.getFileChooser().getAccessory());
        }
 else {
          documentView.setEnabled(true);
          if (oldFocusOwner != null) {
            oldFocusOwner.requestFocus();
          }
        }
      }
    }
);
  }
}
