{
  PegDownFragmentCollector docc=new PegDownFragmentCollector(docdirs);
  JavaFragmentCollector srcc=new JavaFragmentCollector(srcdirs);
  JavaFragmentCollector tstc=new JavaFragmentCollector(tstdirs);
  docc.collect();
  srcc.collect();
  tstc.collect();
  LinkRenderer linkRenderer=new LinkRenderer();
  Map<String,VerbatimSerializer> verbatimSerializerMap=Collections.<String,VerbatimSerializer>emptyMap();
  List<ToHtmlSerializerPlugin> plugins=Collections.emptyList();
  Files.createDirectories(destdir);
  for (  Path srcd : docdirs) {
    Path destfile=destdir.resolve(srcd.getFileName() + ".html");
    System.out.println("writing " + destfile);
    try (PegDownPrintWriter w=new PegDownPrintWriter(new PrintWriter(Files.newBufferedWriter(destfile)))){
      w.print("<!DOCTYPE html><html>\n<body>\n");
      for (      RootNode astRoot : docc.getRootNodesFor(srcd)) {
        new PegDownHtmlSerializer(w,linkRenderer,verbatimSerializerMap,plugins).toHtml(astRoot);
      }
      w.print("\n</body>\n</html>");
    }
   }
}
