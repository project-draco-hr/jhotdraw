{
  try (XMLEncoder o=new XMLEncoder(out)){
    final FigurePersistenceDelegate delegate=new FigurePersistenceDelegate();
    o.setPersistenceDelegate(Figure.class,delegate);
    o.setPersistenceDelegate(Drawing.class,delegate);
    o.setPersistenceDelegate(RectangleFigure.class,delegate);
    o.writeObject(drawing);
  }
 }
