{
  isPressed=false;
  isWorking=false;
  Figure c=null;
  Point2D.Double p=viewToDrawing(new Point(e.getX(),e.getY()));
  getView().getConstrainer().constrainPoint(p);
  if (getStartConnector() != null) {
    c=findTarget(p,getDrawing());
  }
  if (c != null) {
    setEndConnector(findConnector(p,c,prototype));
    if (getEndConnector() != null) {
      CompositeEdit creationEdit=new CompositeEdit("Verbindung erstellen");
      getDrawing().fireUndoableEditHappened(creationEdit);
      ConnectionFigure f=getConnection();
      f.willChange();
      f.setStartConnector(getStartConnector());
      f.setEndConnector(getEndConnector());
      f.setBounds(f.getStartPoint(),p);
      f.updateConnection();
      f.changed();
      f.removeFigureListener(this);
      getDrawing().add(f);
      getDrawing().fireUndoableEditHappened(creationEdit);
    }
  }
 else   if (getConnection() != null) {
    getDrawing().remove(getConnection());
  }
  setConnection(null);
  setStartConnector(null);
  setEndConnector(null);
  setCreatedFigure(null);
  fireToolDone();
}
