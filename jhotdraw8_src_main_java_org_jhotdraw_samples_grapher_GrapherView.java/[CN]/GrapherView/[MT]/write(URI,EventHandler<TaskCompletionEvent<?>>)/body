{
  BackgroundTask<Void> t=new BackgroundTask<Void>(){
    @Override protected void construct() throws Exception {
      if (uri.getPath().endsWith(".svg")) {
        SvgExportOutputFormat io=new SvgExportOutputFormat();
        io.write(uri,drawingView.getDrawing());
      }
 else {
        IdFactory idFactory=new SimpleIdFactory();
        FigureFactory factory=new DefaultFigureFactory(idFactory);
        SimpleXmlIO io=new SimpleXmlIO(factory,idFactory,GRAPHER_NAMESPACE_URI,null);
        io.write(uri,drawingView.getDrawing());
      }
    }
  }
;
  t.addCompletionHandler(callback);
  getApplication().execute(t);
}
