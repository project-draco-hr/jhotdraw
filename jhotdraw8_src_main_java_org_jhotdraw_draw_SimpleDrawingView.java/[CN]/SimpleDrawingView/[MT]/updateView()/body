{
  LinkedList<Figure> updateLayouts=new LinkedList<>(dirtyFigureLayouts);
  dirtyFigureLayouts.clear();
  DrawingModel dm=drawingModel.get();
  for (  Figure f : updateLayouts) {
    dm.layout(f);
  }
  LinkedList<Figure> updateNodes=new LinkedList<>(dirtyFigureNodes);
  dirtyFigureNodes.clear();
  for (  Figure f : updateNodes) {
    f.updateNode(this,getNode(f));
  }
  for (  Handle h : selectionHandles) {
    h.updateNode();
  }
  for (  Handle h : secondaryHandles) {
    h.updateNode();
  }
  if (!dirtyFigureNodes.isEmpty()) {
    repaint();
  }
}
