{
  if (!p.isShowing()) {
    p.setShowing(true);
    File file=p.getFile();
    final JInternalFrame f=new JInternalFrame();
    String title;
    if (file == null) {
      title=labels.getString("unnamedFile");
    }
 else {
      title=file.getName();
    }
    f.setTitle(labels.getFormatted("internalFrameTitle",title,getName(),p.getMultipleOpenId()));
    f.setDefaultCloseOperation(JInternalFrame.DO_NOTHING_ON_CLOSE);
    f.setClosable(true);
    f.setMaximizable(true);
    f.setResizable(true);
    f.setIconifiable(false);
    PreferencesUtil.installInternalFramePrefsHandler(prefs,"project",f,desktopPane);
    Point loc=f.getLocation();
    boolean moved;
    do {
      moved=false;
      for (Iterator i=projects().iterator(); i.hasNext(); ) {
        Project aProject=(Project)i.next();
        if (aProject != p && aProject.isShowing() && SwingUtilities.getRootPane(aProject.getComponent()).getParent().getLocation().equals(loc)) {
          loc.x+=22;
          loc.y+=22;
          moved=true;
          break;
        }
      }
    }
 while (moved);
    f.setLocation(loc);
    f.addInternalFrameListener(new InternalFrameAdapter(){
      @Override public void internalFrameClosing(      final InternalFrameEvent evt){
        setCurrentProject(p);
        getModel().getAction(CloseAction.ID).actionPerformed(new ActionEvent(f,ActionEvent.ACTION_PERFORMED,"windowClosing"));
      }
    }
);
    p.addPropertyChangeListener(new PropertyChangeListener(){
      public void propertyChange(      PropertyChangeEvent evt){
        String name=evt.getPropertyName();
        if (name.equals("hasUnsavedChanges")) {
          ((JInternalFrame)f.getRootPane().getParent()).putClientProperty("windowModified",new Boolean(p.hasUnsavedChanges()));
        }
 else         if (name.equals("file")) {
          f.setTitle((p.getFile() == null) ? "Unnamed" : p.getFile().getName());
        }
      }
    }
);
    f.addPropertyChangeListener(new PropertyChangeListener(){
      public void propertyChange(      PropertyChangeEvent evt){
        String name=evt.getPropertyName();
        if (name.equals("selected")) {
          if (evt.getNewValue().equals(Boolean.TRUE)) {
            setCurrentProject(p);
          }
        }
      }
    }
);
    f.getContentPane().add(p.getComponent());
    f.setVisible(true);
    desktopPane.add(f);
    f.toFront();
    try {
      f.setSelected(true);
    }
 catch (    PropertyVetoException e) {
    }
    p.getComponent().requestFocusInWindow();
  }
}
