{
  ResourceMap labels=getFrameworkResourceMap();
  String baseName;
  if (v.getFile() == null) {
    baseName=labels.getString("File.unnamedFile");
  }
 else {
    baseName=v.getFile().getName();
    if (!isExtensionVisible) {
      int p=baseName.lastIndexOf('.');
      if (p != -1) {
        baseName=baseName.substring(0,p);
      }
    }
  }
  String name=baseName;
  if (name == null || name.startsWith("null")) {
    new Throwable().printStackTrace();
  }
  int count=1;
  boolean success;
  do {
    success=true;
    for (    DocumentView vv : getViews()) {
      if (vv != v && vv.getName() != null && vv.getName().equals(name)) {
        name=baseName + " " + (++count);
        success=false;
        break;
      }
    }
  }
 while (!success);
  v.setName(name);
}
