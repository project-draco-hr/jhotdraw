{
  Drawing oldDrawing=child.getDrawing();
  Figure oldParent=child.getParent();
  if (oldParent != null) {
    int oldChildIndex=oldParent.getChildren().indexOf(child);
    oldParent.remove(child);
    fire(DrawingModelEvent.figureRemovedFromParent((DrawingModel)this,child,oldParent,oldChildIndex));
    fire(DrawingModelEvent.nodeInvalidated((DrawingModel)this,oldParent));
  }
  parent.getChildren().add(index,child);
  Drawing newDrawing=child.getDrawing();
  if (oldDrawing != newDrawing) {
    if (oldDrawing != null) {
      for (      Figure f : child.preorderIterable()) {
        fire(DrawingModelEvent.figureRemovedFromDrawing((DrawingModel)this,oldDrawing,f));
      }
    }
    if (newDrawing != null) {
      for (      Figure f : child.preorderIterable()) {
        fire(DrawingModelEvent.figureAddedToDrawing((DrawingModel)this,newDrawing,f));
      }
    }
  }
  fire(DrawingModelEvent.figureAddedToParent((DrawingModel)this,child,parent,index));
  fire(DrawingModelEvent.nodeInvalidated((DrawingModel)this,parent));
}
