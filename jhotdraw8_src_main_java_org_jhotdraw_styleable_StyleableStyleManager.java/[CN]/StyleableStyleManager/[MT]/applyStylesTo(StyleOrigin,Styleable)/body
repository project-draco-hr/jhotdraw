{
  List<CssMetaData<? extends Styleable,?>> metaList=elem.getCssMetaData();
  HashMap<String,CssMetaData<? extends Styleable,?>> metaMap=new HashMap<>();
  for (  CssMetaData<? extends Styleable,?> m : metaList) {
    metaMap.put(m.getProperty(),m);
  }
  if (origin == null || origin == StyleOrigin.USER_AGENT) {
    for (    Entry e : getUserAgentStylesheets()) {
      Stylesheet s=e.getStylesheet();
      if (s != null) {
        applyStylesTo(StyleOrigin.USER_AGENT,s,metaMap,elem);
      }
    }
  }
  if (origin == null || origin == StyleOrigin.AUTHOR) {
    for (    Entry e : getAuthorStylesheets()) {
      Stylesheet s=e.getStylesheet();
      if (s != null) {
        applyStylesTo(StyleOrigin.AUTHOR,s,metaMap,elem);
      }
    }
  }
  if (origin == null || origin == StyleOrigin.INLINE) {
    for (    Entry e : getAuthorStylesheets()) {
      Stylesheet s=e.getStylesheet();
      if (s != null) {
        applyStylesTo(StyleOrigin.INLINE,s,metaMap,elem);
      }
    }
  }
  if (origin == null || origin == StyleOrigin.INLINE) {
    applyInlineStylesTo(metaMap,elem);
  }
  metaMap.clear();
}
