{
  if (getTypingTarget() != null) {
    if (fTextField.getText().length() > 0) {
      getTypingTarget().setText(fTextField.getText());
    }
 else {
      drawing().orphan((Figure)getAddedFigure());
    }
    getUndoActivity().setAffectedFigures(new SingleFigureEnumerator(getAddedFigure()));
    ((TextTool.UndoActivity)getUndoActivity()).setBackupText(getTypingTarget().getText());
    setTypingTarget(null);
    fTextField.endOverlay();
  }
}
