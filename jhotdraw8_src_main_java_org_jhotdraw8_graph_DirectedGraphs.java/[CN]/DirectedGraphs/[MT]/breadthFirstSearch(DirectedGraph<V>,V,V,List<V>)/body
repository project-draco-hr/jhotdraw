{
  Set<V> visited=new HashSet<>(graph.getVertexCount());
  Queue<BackLink<V>> queue=new ArrayDeque<>(max(1,min(graph.getVertexCount(),graph.getEdgeCount())));
  BackLink<V> rootBackLink=new BackLink<>(root,null);
  visited.add(root);
  queue.add(rootBackLink);
  BackLink<V> current=null;
  while (!queue.isEmpty()) {
    current=queue.remove();
    if (current.vertex == goal) {
      break;
    }
    for (int i=0, n=graph.getNextCount(current.vertex); i < n; i++) {
      V next=graph.getNext(current.vertex,i);
      if (visited.add(next)) {
        BackLink<V> backLink=new BackLink<>(next,current);
        queue.add(backLink);
      }
    }
  }
  if (current == null || current.vertex != goal) {
    return false;
  }
  for (BackLink<V> i=current; i.vertex != root; i=i.parent) {
    pathElements.add(null);
  }
  int insertionPoint=pathElements.size();
  for (BackLink<V> i=current; i.vertex != root; i=i.parent) {
    pathElements.set(--insertionPoint,i.vertex);
  }
  return true;
}
