{
  javafx.scene.Group groupNode=(javafx.scene.Group)node;
  node.getTransforms().setAll(getLocalToParent(true));
  Rectangle contentBoundsNode=(Rectangle)groupNode.getProperties().get("contentBounds");
  Path pageBoundsNode=(Path)groupNode.getProperties().get("pageBounds");
  javafx.scene.Group currentPageNode=(javafx.scene.Group)groupNode.getProperties().get("currentPage");
  applyHideableFigureProperties(node);
  if (ctx.get(RenderContext.RENDERING_INTENT) == RenderingIntent.EDITOR) {
    node.setVisible(true);
    contentBoundsNode.setVisible(true);
    pageBoundsNode.setVisible(true);
  }
 else   if (ctx.get(RenderContext.RENDER_PAGE) == this) {
    node.setVisible(true);
    contentBoundsNode.setVisible(false);
    pageBoundsNode.setVisible(false);
  }
 else {
    node.setVisible(false);
  }
  double contentWidth=get(WIDTH);
  double contentHeight=get(HEIGHT);
  contentBoundsNode.setX(get(X));
  contentBoundsNode.setY(get(Y));
  contentBoundsNode.setWidth(contentWidth);
  contentBoundsNode.setHeight(contentHeight);
  int numPagesX=Math.max(1,getStyled(NUM_PAGES_X).intValue());
  int numPagesY=Math.max(1,getStyled(NUM_PAGES_Y).intValue());
  final ObservableList<PathElement> l=pageBoundsNode.getElements();
  l.clear();
  for (int i=0, n=numPagesX * numPagesY; i < n; i++) {
    Bounds b=getPageBounds(i);
    double x=b.getMinX();
    double y=b.getMinY();
    double w=b.getWidth();
    double h=b.getHeight();
    l.add(new MoveTo(x,y));
    l.add(new LineTo(x + w,y));
    l.add(new LineTo(x + w,y + h));
    l.add(new LineTo(x,y + h));
    l.add(new ClosePath());
  }
  List<Node> currentPageChildren=new ArrayList<Node>(getChildren().size() + 2);
  int currentPage=ctx.get(RenderContext.RENDER_PAGE_INTERNAL_NUMBER);
  currentPageNode.getTransforms().setAll(getPageTranslate(currentPage));
  for (  Figure child : getChildren()) {
    currentPageChildren.add(ctx.getNode(child));
  }
  ObservableList<Node> group=currentPageNode.getChildren();
  if (!group.equals(currentPageChildren)) {
    group.setAll(currentPageChildren);
  }
}
