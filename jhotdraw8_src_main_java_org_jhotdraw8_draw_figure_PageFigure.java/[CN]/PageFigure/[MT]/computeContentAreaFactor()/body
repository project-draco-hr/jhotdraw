{
  double contentWidth=get(WIDTH);
  double contentHeight=get(HEIGHT);
  Insets insets=getStyled(PAGE_INSETS);
  double overlap=getStyled(PAGE_OVERLAP);
  int numPagesX=Math.max(1,getStyled(NUM_PAGES_X).intValue());
  int numPagesY=Math.max(1,getStyled(NUM_PAGES_Y).intValue());
  double contentAreaWidth=(get(PAPER_WIDTH) - insets.getLeft() - insets.getRight()) * numPagesX;
  double contentAreaHeight=(get(PAPER_HEIGHT) - insets.getTop() - insets.getBottom()) * numPagesY;
  double contentRatio=contentWidth / contentHeight;
  double contentAreaRatio=contentAreaWidth / contentAreaHeight;
  double contentAreaFactor;
  if (contentRatio > contentAreaRatio) {
    contentAreaFactor=(contentWidth + overlap * (numPagesX - 1)) / contentAreaWidth;
  }
 else {
    contentAreaFactor=(contentHeight + overlap * (numPagesY - 1)) / contentAreaHeight;
  }
  return contentAreaFactor;
}
