{
  JFileURIChooser c=new JFileURIChooser();
  fileFilterOutputFormatMap=new HashMap<javax.swing.filechooser.FileFilter,OutputFormat>();
  javax.swing.filechooser.FileFilter currentFilter=null;
  for (  OutputFormat format : view.getDrawing().getOutputFormats()) {
    javax.swing.filechooser.FileFilter ff=format.getFileFilter();
    fileFilterOutputFormatMap.put(ff,format);
    c.addChoosableFileFilter(ff);
    if (ff.getDescription().equals(preferences.get("viewExportFormat",""))) {
      currentFilter=ff;
    }
  }
  if (currentFilter != null) {
    c.setFileFilter(currentFilter);
  }
  c.setSelectedFile(new File(preferences.get("viewExportFile",System.getProperty("user.home"))));
  return c;
}
