{
  Rectangle2D rx=getTransformedShape().getBounds2D();
  Rectangle2D.Double r=(rx instanceof Rectangle2D.Double) ? (Rectangle2D.Double)rx : new Rectangle2D.Double(rx.getX(),rx.getY(),rx.getWidth(),rx.getHeight());
  if (TRANSFORM.get(this) == null) {
    double g=ODGAttributeKeys.getPerpendicularHitGrowth(this) * 2;
    Geom.grow(r,g,g);
  }
 else {
    double strokeTotalWidth=AttributeKeys.getStrokeTotalWidth(this);
    double width=strokeTotalWidth / 2d;
    if (STROKE_JOIN.get(this) == BasicStroke.JOIN_MITER) {
      width*=STROKE_MITER_LIMIT.get(this);
    }
    if (STROKE_CAP.get(this) != BasicStroke.CAP_BUTT) {
      width+=strokeTotalWidth * 2;
    }
    width++;
    Geom.grow(r,width,width);
  }
  return r;
}
