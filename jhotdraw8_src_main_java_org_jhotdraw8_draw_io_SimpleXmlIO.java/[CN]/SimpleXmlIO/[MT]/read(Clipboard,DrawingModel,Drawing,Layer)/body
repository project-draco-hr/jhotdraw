{
  setInternalHome(drawing.get(Drawing.DOCUMENT_HOME));
  setExternalHome(new File(System.getProperty("user.home")).toURI());
  Object content=clipboard.getContent(getDataFormat());
  if (content instanceof String) {
    Set<Figure> figures=new LinkedHashSet<>();
    Drawing newDrawing=read((String)content,drawing);
    factory.reset();
    for (    Figure f : drawing.preorderIterable()) {
      factory.createId(f);
    }
    if (layer == null) {
      layer=(Layer)drawing.getLastChild();
      if (layer == null) {
        layer=new SimpleLayer();
        layer.set(StyleableFigure.STYLE_ID,factory.createId(layer));
        model.addChildTo(layer,drawing);
      }
    }
    for (    Figure f : new ArrayList<>(newDrawing.getChildren())) {
      newDrawing.remove(f);
      String id=factory.createId(f);
      f.set(StyleableFigure.STYLE_ID,id);
      if (f instanceof Layer) {
        model.addChildTo(f,drawing);
      }
 else {
        model.addChildTo(f,layer);
      }
    }
    return figures;
  }
 else {
    throw new IOException("no data found");
  }
}
