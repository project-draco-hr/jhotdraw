{
  if (updateDepth++ == 0) {
    Set<Figure> figures=getEditedFigures();
    if (activeView == null || figures.isEmpty()) {
    }
 else {
      T value=attributeEditor.getAttributeValue();
      if (attributeRestoreData == null) {
        attributeRestoreData=new LinkedList<Object>();
        for (        Figure f : figures) {
          attributeRestoreData.add(f.getAttributesRestoreData());
          attributeKey.set(f,value);
        }
      }
 else {
        for (        Figure f : figures) {
          attributeKey.set(f,value);
        }
      }
      if (drawingEditor != null && isUpdateDrawingEditorDefaults) {
        drawingEditor.setDefaultAttribute(attributeKey,value);
      }
      getActiveView().getDrawing().fireUndoableEditHappened(new UndoableAttributeEdit<T>(new HashSet<Figure>(figures),attributeKey,value,attributeRestoreData));
      if (!attributeEditor.getValueIsAdjusting()) {
        attributeRestoreData=null;
      }
    }
  }
  updateDepth--;
}
