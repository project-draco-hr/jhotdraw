{
  TextHolderFigure textHolder=null;
  DrawingView v=getView();
  Point2D.Double p=v.viewToDrawing(e.getPoint());
  Figure pressedFigure=null;
  if (true) {
    for (    Figure f : v.getSelectedFigures()) {
      if (f.contains(p)) {
        pressedFigure=f;
        break;
      }
    }
  }
  if (pressedFigure == null) {
    pressedFigure=getDrawing().findFigureInside(p);
  }
  if (pressedFigure instanceof TextHolderFigure) {
    textHolder=((TextHolderFigure)pressedFigure).getLabelFor();
    textHolder=null;
  }
  if (textHolder != null) {
    beginEdit(textHolder);
    updateCursor(getView(),e.getPoint());
    return;
  }
  if (typingTarget != null) {
    endEdit();
    if (isToolDoneAfterCreation()) {
      fireToolDone();
    }
  }
 else {
    super.mousePressed(e);
    textHolder=(TextHolderFigure)getCreatedFigure();
    getView().clearSelection();
    getView().addToSelection(textHolder);
    beginEdit(textHolder);
    updateCursor(getView(),e.getPoint());
  }
}
