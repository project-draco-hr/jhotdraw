{
  int unsavedProjectsCount=0;
  Project documentToBeReviewed=null;
  for (  Project p : WindowManager.getInstance().projects()) {
    if (p.hasUnsavedChanges()) {
      if (p.isEnabled()) {
        documentToBeReviewed=p;
      }
      unsavedProjectsCount++;
    }
  }
  if (unsavedProjectsCount == 0) {
    doExit();
  }
 else   if (documentToBeReviewed != null) {
    unsavedProject=documentToBeReviewed;
    reviewChanges();
  }
 else {
    getApplication().setEnabled(true);
  }
}
