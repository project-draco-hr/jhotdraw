{
  int oldValue=getDisclosureState();
  disclosureButton.putClientProperty(DisclosureIcon.CURRENT_STATE_PROPERTY,newValue);
  Component[] components=getComponents();
  for (int i=0; i < components.length; i++) {
    if (components[i] != disclosureButton) {
      remove(components[i]);
    }
  }
  JComponent c=getDisclosedComponent(newValue);
  GridBagLayout layout=(GridBagLayout)getLayout();
  GridBagConstraints gbc=new GridBagConstraints();
  if (c != null) {
    gbc=new GridBagConstraints();
    gbc.gridx=1;
    gbc.weightx=1d;
    gbc.weighty=1d;
    gbc.fill=GridBagConstraints.BOTH;
    gbc.anchor=GridBagConstraints.WEST;
    add(c,gbc);
    gbc=layout.getConstraints(disclosureButton);
    gbc.weightx=0d;
    layout.setConstraints(disclosureButton,gbc);
  }
 else {
    gbc=layout.getConstraints(disclosureButton);
    gbc.weightx=1d;
    layout.setConstraints(disclosureButton,gbc);
  }
  invalidate();
  Container parent=getParent();
  while (parent.getParent() != null && !parent.getParent().isValid()) {
    parent=parent.getParent();
  }
  parent.validate();
  firePropertyChange(DISCLOSURE_STATE_PROPERTY,oldValue,newValue);
}
