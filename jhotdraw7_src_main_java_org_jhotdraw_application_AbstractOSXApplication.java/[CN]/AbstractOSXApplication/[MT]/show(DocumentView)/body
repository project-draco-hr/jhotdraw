{
  ResourceMap labels=getResourceMap();
  updateName(p);
  final JFrame f=new JFrame();
  f.setTitle(labels.getString("internalFrameTitle",labels.getString("Application.title"),p.getName()));
  f.setDefaultCloseOperation(JFrame.DO_NOTHING_ON_CLOSE);
  f.setPreferredSize(new Dimension(400,400));
  Preferences prefs=Preferences.userNodeForPackage(getClass());
  PreferencesUtil.installFramePrefsHandler(prefs,"documentView",f);
  Point loc=f.getLocation();
  boolean moved;
  do {
    moved=false;
    for (Iterator i=getViews().iterator(); i.hasNext(); ) {
      DocumentView aProject=(DocumentView)i.next();
      if (aProject != p && SwingUtilities.getWindowAncestor(aProject.getComponent()).getLocation().equals(loc)) {
        loc.x+=22;
        loc.y+=22;
        moved=true;
        break;
      }
    }
  }
 while (moved);
  f.setLocation(loc);
  paletteHandler.add(f,p);
  f.addWindowListener(new WindowAdapter(){
    public void windowClosing(    final WindowEvent evt){
      setCurrentView(p);
      getAction(CloseAction.ID).actionPerformed(new ActionEvent(f,ActionEvent.ACTION_PERFORMED,"windowClosing"));
    }
  }
);
  p.addPropertyChangeListener(new PropertyChangeListener(){
    public void propertyChange(    PropertyChangeEvent evt){
      String name=evt.getPropertyName();
      if (name.equals("hasUnsavedChanges")) {
        f.getRootPane().putClientProperty("windowModified",new Boolean(p.isModified()));
      }
 else       if (name.equals("file")) {
        f.setTitle((p.getFile() == null) ? "Unnamed" : p.getFile().getName());
      }
    }
  }
);
  f.setJMenuBar(createMenuBar(p));
  f.getContentPane().add(p.getComponent());
  f.setVisible(true);
}
