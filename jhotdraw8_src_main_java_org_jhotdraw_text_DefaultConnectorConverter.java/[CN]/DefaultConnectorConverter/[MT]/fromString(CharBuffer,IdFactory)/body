{
  Object[] v=formatter.fromString(buf);
  if (v == null) {
    return null;
  }
  String id=(String)v[0];
  double choice=(Double)v[1];
  Object target=idFactory.getObject(id);
  if (!(target instanceof Figure)) {
    throw new IOException("bad id: " + id);
  }
  Figure targetFigure=(Figure)target;
  Class<?> clazz=choiceToConnectorMap.get(choice);
  try {
    Connector connector=(Connector)clazz.getConstructor(Figure.class).newInstance(targetFigure);
    return connector;
  }
 catch (  NoSuchMethodException|SecurityException|InstantiationException|IllegalAccessException|IllegalArgumentException|InvocationTargetException ex) {
    throw new InternalError(ex);
  }
}
