{
  Queue<BackLinkWithEdge<V,E>> queue=new ArrayDeque<>(max(1,min(graph.getVertexCount(),graph.getEdgeCount())));
  BackLinkWithEdge<V,E> rootBackLink=new BackLinkWithEdge<>(root,null,null);
  visited.test(root);
  queue.add(rootBackLink);
  BackLinkWithEdge<V,E> current=null;
  while (!queue.isEmpty()) {
    current=queue.remove();
    if (current.vertex == goal) {
      break;
    }
    for (int i=0, n=graph.getNextCount(current.vertex); i < n; i++) {
      V next=graph.getNext(current.vertex,i);
      E edge=graph.getNextEdge(current.vertex,i);
      if (visited.test(next)) {
        BackLinkWithEdge<V,E> backLink=new BackLinkWithEdge<>(next,current,edge);
        queue.add(backLink);
      }
    }
  }
  if (current == null || current.vertex != goal) {
    return null;
  }
  return current;
}
