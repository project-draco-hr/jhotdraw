{
  if (drawing.getOutputFormats() == null || drawing.getOutputFormats().size() == 0) {
    getToolkit().beep();
    return;
  }
  java.util.List<Figure> toBeCopied=drawing.sort(getSelectedFigures());
  if (toBeCopied.size() > 0) {
    try {
      CompositeTransferable transfer=new CompositeTransferable();
      for (      OutputFormat format : drawing.getOutputFormats()) {
        Transferable t=format.createTransferable(toBeCopied,scaleFactor);
        if (!transfer.isDataFlavorSupported(t.getTransferDataFlavors()[0])) {
          transfer.add(t);
        }
      }
      getToolkit().getSystemClipboard().setContents(transfer,transfer);
    }
 catch (    IOException e) {
      e.printStackTrace();
      getToolkit().beep();
    }
  }
}
