{
  if (cachedPreferredSize == null) {
    double oldTx=translate.x;
    double oldTy=translate.y;
    Rectangle2D.Double r=getDrawingArea();
    translate.x=Math.min(0,r.x);
    translate.y=Math.min(0,r.y);
    cachedPreferredSize=new Dimension((int)((r.width + 10 - translate.x) * scaleFactor),(int)((r.height + 10 - translate.y) * scaleFactor));
    fireViewTransformChanged();
    if (oldTx != translate.x || oldTy != translate.y) {
      repaint();
    }
  }
  return cachedPreferredSize;
}
