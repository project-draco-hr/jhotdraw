{
  MenuBar mb=model.createMenuBar();
  Deque<Menu> todo=new LinkedList<>(mb.getMenus());
  while (!todo.isEmpty()) {
    for (    MenuItem mi : todo.remove().getItems()) {
      if (mi instanceof Menu) {
        todo.add((Menu)mi);
      }
 else {
        Action a=actions.get(mi.getId());
        if (a != null) {
          Actions.bindMenuItem(mi,a);
        }
 else {
          System.err.println("Warning DocumentOrientedApplication no action for menu item with id:" + mi.getId());
          a=new AbstractProjectAction<Project>(this,null,null){
            @Override protected void handleActionPerformed(            ActionEvent event,            Project p){
              Action ava=getActiveProject().getActionMap().get(mi.getId());
              if (ava != null) {
                ava.handle(event);
              }
            }
          }
;
          systemMenuActiveProjectActions.add(a);
          Actions.bindMenuItem(mi,a,false);
        }
      }
    }
  }
  updateRecentMenuItemsMB(mb.getMenus());
  return mb;
}
