{
  final int indexIfAbsent=keyMap.size();
  Integer indexIfPresent=keyMap.putIfAbsent(key,indexIfAbsent);
  int index=indexIfPresent == null ? indexIfAbsent : indexIfPresent;
  for (int i=values.size(), n=(1 + index) * numOrigins; i < n; i++) {
    values.add(EMPTY);
  }
  return index;
}
