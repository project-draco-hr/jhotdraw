{
  File dir=getDirectory();
  if (!dir.isDirectory()) {
    if (!dir.mkdirs()) {
      throw new LSException("couldn't create directory " + dir);
    }
  }
  File path=new File(dir,fileName);
  try {
    return new BufferedOutputStream(new FileOutputStream(path));
  }
 catch (  IOException e) {
    throw new LSException("couldn't open output file \"" + fileName + "\"",e);
  }
}
