{
  AbortExceptionListener el=new AbortExceptionListener();
  XMLEncoder e=null;
  ByteArrayOutputStream bst=new ByteArrayOutputStream();
  try {
    e=new XMLEncoder(bst);
    e.setExceptionListener(el);
    e.setPersistenceDelegate(Rectangle.class,new RectanglePD());
    e.writeObject(bean);
  }
  finally {
    if (e != null) {
      e.close();
    }
  }
  if (el.exception != null) {
    throw new LSException("save failed \"" + fileName + "\"",el.exception);
  }
  OutputStream ost=null;
  try {
    ost=openOutputFile(fileName);
    ost.write(bst.toByteArray());
  }
  finally {
    if (ost != null) {
      ost.close();
    }
  }
}
