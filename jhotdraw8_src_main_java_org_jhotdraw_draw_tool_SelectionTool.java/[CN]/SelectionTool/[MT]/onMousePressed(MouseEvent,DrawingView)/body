{
  mouseDragged=false;
  Bounds b=getNode().getBoundsInParent();
  Drawing drawing=view.getDrawing();
  double vx=evt.getX();
  double vy=evt.getY();
  pressedFigure=view.findFigure(vx,vy);
  if (pressedFigure == null) {
    List<Figure> fs=view.findFiguresIntersecting(vx - tolerance,vy - tolerance,tolerance * 2,tolerance * 2);
    if (!fs.isEmpty()) {
      pressedFigure=fs.get(0);
    }
  }
  if (isSelectBehindEnabled() && (evt.isAltDown())) {
    pressedFigure=view.findFigureBehind(vx,vy,pressedFigure);
  }
  if (evt.isShiftDown() && !evt.isMetaDown()) {
    if (pressedFigure != null) {
      view.getSelectedFigures().add(pressedFigure);
    }
  }
 else   if (!evt.isShiftDown() && evt.isMetaDown()) {
    if (pressedFigure != null) {
      if (view.selectionProperty().contains(pressedFigure)) {
        view.selectionProperty().remove(pressedFigure);
      }
 else {
        view.selectionProperty().add(pressedFigure);
      }
    }
  }
 else   if (!evt.isShiftDown() && !evt.isMetaDown()) {
    if (pressedFigure != null && !view.selectionProperty().contains(pressedFigure)) {
      view.selectionProperty().clear();
      view.selectionProperty().add(pressedFigure);
    }
  }
  if (pressedFigure != null && (!(evt.isControlDown()) || view.selectionProperty().contains(pressedFigure))) {
    DragTracker t=getDragTracker(pressedFigure,view);
    setTracker(t);
  }
 else {
    SelectAreaTracker t=getSelectAreaTracker();
    setTracker(t);
  }
  if (tracker != null) {
    tracker.trackMousePressed(evt,view);
  }
  fireToolStarted();
}
