{
  for (  StyleRule r : s.getRulesets()) {
    if (r.getSelectorGroup().matches(selectorModel,elem)) {
      for (      Declaration d : r.getDeclarations()) {
        @SuppressWarnings("unchecked") StyleableKey<Object> k=(StyleableKey<Object>)metaMap.get(d.getProperty());
        if (k != null) {
          if (!convertedValues.containsKey(d)) {
            @SuppressWarnings("unchecked") Converter<Object> converter=k.getConverter();
            try {
              convertedValues.put(d,converter.fromString(d.getTermsAsString()));
            }
 catch (            ParseException|IOException ex) {
              System.err.println("Warning FigureStyleManager can not convert CSS term to string. " + d.getProperty() + ":"+ d.getTermsAsString());
              ex.printStackTrace();
            }
          }
          if (convertedValues.containsKey(d)) {
            Object convertedValue=convertedValues.get(d);
            elem.setStyled(origin,k,convertedValue);
          }
        }
      }
    }
  }
}
