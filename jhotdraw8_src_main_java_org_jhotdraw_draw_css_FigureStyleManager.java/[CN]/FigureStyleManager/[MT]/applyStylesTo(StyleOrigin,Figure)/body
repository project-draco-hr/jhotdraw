{
  Set<MapAccessor<?>> metaList=elem.getSupportedKeys();
  HashMap<String,MapAccessor<?>> metaMap=new HashMap<>();
  for (  MapAccessor<?> k : metaList) {
    if (k instanceof StyleableMapAccessor) {
      StyleableMapAccessor<?> sk=(StyleableMapAccessor<?>)k;
      metaMap.put(sk.getCssName(),k);
    }
  }
  if (origin == null || origin == StyleOrigin.USER_AGENT) {
    elem.removeAll(StyleOrigin.USER_AGENT);
    for (    MyEntry e : getUserAgentStylesheets()) {
      Stylesheet s=e.getStylesheet();
      if (s != null) {
        applyStylesTo(StyleOrigin.USER_AGENT,s,metaMap,elem);
      }
    }
  }
  if (origin == null || origin == StyleOrigin.AUTHOR) {
    elem.removeAll(StyleOrigin.AUTHOR);
    for (    MyEntry e : getAuthorStylesheets()) {
      Stylesheet s=e.getStylesheet();
      if (s != null) {
        applyStylesTo(StyleOrigin.AUTHOR,s,metaMap,elem);
      }
    }
  }
  if (origin == null || origin == StyleOrigin.INLINE) {
    elem.removeAll(StyleOrigin.INLINE);
    for (    MyEntry e : getInlineStylesheets()) {
      Stylesheet s=e.getStylesheet();
      if (s != null) {
        applyStylesTo(StyleOrigin.INLINE,s,metaMap,elem);
      }
    }
    applyInlineStylesTo(metaMap,elem);
  }
  metaMap.clear();
}
