{
  if (join == BasicStroke.JOIN_MITER) {
    if (prevTangent != null) {
      Point3D intersectionh=myTangent.crossProduct(prevTangent);
      if (abs(intersectionh.getZ()) > EPSILON) {
        Point2D intersection=Geom.homogenize2D(intersectionh);
        double sqdist=Geom.squaredDistance(intersection,x,y);
        if (sqdist > EPSILON && sqdist < sqMiterLimit) {
          if (movePending) {
            out.moveTo(intersection.getX(),intersection.getY());
            movePending=false;
          }
 else {
            out.lineTo(intersection.getX(),intersection.getY());
          }
          return;
        }
      }
    }
  }
  if (movePending) {
    out.moveTo(x,y);
    movePending=false;
  }
 else {
    out.lineTo(x,y);
  }
}
