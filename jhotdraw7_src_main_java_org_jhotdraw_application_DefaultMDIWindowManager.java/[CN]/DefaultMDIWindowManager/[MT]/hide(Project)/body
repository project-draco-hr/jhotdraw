{
  if (p.isShowing()) {
    JInternalFrame f=(JInternalFrame)SwingUtilities.getRootPane(p.getComponent()).getParent();
    f.setVisible(false);
    f.remove(p.getComponent());
    desktopPane.remove(f);
    f.dispose();
  }
}
