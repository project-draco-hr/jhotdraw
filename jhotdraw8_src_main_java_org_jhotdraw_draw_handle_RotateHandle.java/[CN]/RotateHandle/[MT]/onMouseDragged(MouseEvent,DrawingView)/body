{
  Point2D newPoint=view.viewToWorld(new Point2D(event.getX(),event.getY()));
  double oldRotate=90 + 180.0 / Math.PI * Geom.angle(center.getX(),center.getY(),oldPoint.getX(),oldPoint.getY());
  double newRotate=90 + 180.0 / Math.PI * Geom.angle(center.getX(),center.getY(),newPoint.getX(),newPoint.getY());
  double ownerAngle=getOwner().get(TransformableFigure.ROTATE);
  newRotate=newRotate % 360;
  if (newRotate < 0) {
    newRotate+=360;
  }
  if (!event.isAltDown() && !event.isControlDown()) {
    newRotate=view.getConstrainer().constrainAngle(getOwner(),newRotate);
  }
  if (event.isMetaDown()) {
  }
  DrawingModel model=view.getModel();
  if (event.isShiftDown()) {
    for (    Figure f : groupReshapeableFigures) {
      if (f instanceof TransformableFigure)       model.set(f,TransformableFigure.ROTATE,newRotate);
    }
  }
 else {
    model.set(getOwner(),TransformableFigure.ROTATE,newRotate);
  }
  oldPoint=newPoint;
}
